{{define "content"}}{{template "start" .}}
<style>
</style>
{{template "header" .}}
<main id="app">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-lg-push-4 col-sm-6 col-sm-push-3">
                <section class="content-inner">
                    <div class="card">
                        <div class="card-main">
                            <div class="card-header">
                                <div class="card-inner">
                                    <h1 class="card-heading">Sign In</h1>
                                </div>
                            </div>
                            <div class="card-inner">
                                <p class="text-center">
                                    <span class="avatar avatar-inline avatar-lg">
                                        <img alt="Login" src="/static/img/avatar.jpg">
                                    </span>
                                </p>
                                <div class="form-group form-group-label">
                                    <div class="row">
                                        <div class="col-md-10 col-md-push-1">
                                            <label class="floating-label" for="sign_in_email">Email</label>
                                            <input v-model="email" class="form-control" id="sign_in_email" type="text">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group form-group-label">
                                    <div class="row">
                                        <div class="col-md-10 col-md-push-1">
                                            <label class="floating-label" for="sign_in_password">Password</label>
                                            <input v-model="password" class="form-control" id="sign_in_password"
                                                   type="password">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-10 col-md-push-1">
                                            <button @click="onSubmit" class="btn btn-block btn-brand waves-attach">
                                                SignIn
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-10 col-md-push-1">
                                            <div class="checkbox checkbox-adv">
                                                <label for="ui_login_remember">
                                                    <input class="access-hide" id="ui_login_remember"
                                                           name="ui_login_remember" type="checkbox">Stay signed in
                                                    <span class="checkbox-circle"></span>
                                                    <span class="checkbox-circle-check"></span>
                                                    <span class="checkbox-circle-icon icon">done</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> <!---card-inner-->
                        </div><!---card-main-->
                    </div><!--card-->
                    <div class="clearfix">
                        <p class="margin-no-top pull-left">
                            <a class="btn btn-flat btn-brand waves-attach" href="javascript:void(0)">Need help?</a>
                        </p>
                        <p class="margin-no-top pull-right">
                            <a class="btn btn-flat btn-brand waves-attach" href="javascript:void(0)">Create an
                                account</a>
                        </p>
                    </div>
                </section>
            </div>
        </div>
    </div>
</main>
{{template "footer" .}}
{{template "scripts" .}}
<script src="/static/js/util.js" type="text/javascript"></script>
<script>
    var ErrorSnackbar = "Oh,Snap! 出了点错误";
    new Vue({
        "el": "#app",
        data: {
            email: "",
            password: ""
        },
        methods: {
            onSubmit: function () {
                if(this.email == null){
                    $("body").snackbar({alive: 3500, content: "邮箱不能为空"});
                }else if(this.password == ""){
                    $("body").snackbar({alive: 3500, content: "密码不能为空"});
                }else{
                    try { //cookie may be null or something else bad data
                        xsrf = base64_decode(Cookies.get('_xsrf').split("|")[0]);
                    } catch (err) {
                        $("body").snackbar({alive: 3500, content: ErrorSnackbar});
                        return
                    }
                    var self = this;
                    $.ajax({
                        type: 'POST',
                        data: {_xsrf: xsrf, email: self.email, password: self.password},
                        success: function (data) {
                            if(data.Status == 1){
                                window.location.replace(data.Addition)
                            }else if(data.Status == 0){
                                Util.parseError.init(data.Error)
                            }else{
                                setErrorAlert(ERROR_MESSAGE);
                            }
                        }, error: function () {
                            $("body").snackbar({alive: 3500, content: ErrorSnackbar});
                        }
                    });
                } //else end
            }
        }
    });
</script>
{{template "end" .}}
{{end}}